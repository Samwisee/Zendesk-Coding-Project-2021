<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="">
    <title>Samdesk</title>
  </head>
  <body>
    <h1>Samdesk Ticketing</h1>
      <table>
        <thead>
          <tr>Subject</tr>
          <tr>Priority</tr>
        </thead>
        <tbody id="table-body">
        </tbody>
      </table>
      
      <div id="ticketingWindow"></div>
      <div id="pagination">
        <a href="">Prev</a>
        <a href="">1</a>
        <a href="">2</a>
        <a href="">3</a>
        <a href="">Next</a>
      </div>
    <script>

      const array = [
  {
    url: "https://samcheney.zendesk.com/api/v2/tickets/1.json",
    id: 1,
    external_id: null,
    via: { channel: "sample_ticket", source: { from: [Object], to: [Object], rel: null } },
    created_at: "2021-05-03T23:11:21Z",
    updated_at: "2021-05-03T23:11:22Z",
    type: "incident",
    subject: "Sample ticket: Meet the ticket",
    raw_subject: "Sample ticket: Meet the ticket",
    description: "Hi Sam,\n\nThis is your first ticket. Ta-da! Any customer request sent to your supported channels (ema...",
    priority: "normal",
    status: "open",
    recipient: null,
    requester_id: 902094189446,
    submitter_id: 902095768443,
    assignee_id: 902095768443,
    organization_id: null,
    group_id: 900004607946,
    collaborator_ids: [],
    follower_ids: [],
    email_cc_ids: [],
    forum_topic_id: null,
    problem_id: null,
    has_incidents: false,
    is_public: true,
    due_at: null,
    tags: [ "sample", "support", "zendesk" ],
    custom_fields: [],
    satisfaction_rating: null,
    sharing_agreement_ids: [],
    fields: [],
    followup_ids: [],
    ticket_form_id: 900000356846,
    brand_id: 900001274646,
    allow_channelback: false,
    allow_attachments: true
  },
  {
    url: "https://samcheney.zendesk.com/api/v2/tickets/1.json",
    id: 1,
    external_id: null,
    via: { channel: "sample_ticket", source: { from: [Object], to: [Object], rel: null } },
    created_at: "2021-05-03T23:11:21Z",
    updated_at: "2021-05-03T23:11:22Z",
    type: "incident",
    subject: "Sample ticket: Meet the ticket",
    raw_subject: "Sample ticket: Meet the ticket",
    description: "Hi Sam,\n\nThis is your first ticket. Ta-da! Any customer request sent to your supported channels (ema...",
    priority: "normal",
    status: "open",
    recipient: null,
    requester_id: 902094189446,
    submitter_id: 902095768443,
    assignee_id: 902095768443,
    organization_id: null,
    group_id: 900004607946,
    collaborator_ids: [],
    follower_ids: [],
    email_cc_ids: [],
    forum_topic_id: null,
    problem_id: null,
    has_incidents: false,
    is_public: true,
    due_at: null,
    tags: [ "sample", "support", "zendesk" ],
    custom_fields: [],
    satisfaction_rating: null,
    sharing_agreement_ids: [],
    fields: [],
    followup_ids: [],
    ticket_form_id: 900000356846,
    brand_id: 900001274646,
    allow_channelback: false,
    allow_attachments: true
  },
  {
    url: "https://samcheney.zendesk.com/api/v2/tickets/1.json",
    id: 1,
    external_id: null,
    via: { channel: "sample_ticket", source: { from: [Object], to: [Object], rel: null } },
    created_at: "2021-05-03T23:11:21Z",
    updated_at: "2021-05-03T23:11:22Z",
    type: "incident",
    subject: "Sample ticket: Meet the ticket",
    raw_subject: "Sample ticket: Meet the ticket",
    description: "Hi Sam,\n\nThis is your first ticket. Ta-da! Any customer request sent to your supported channels (ema...",
    priority: "normal",
    status: "open",
    recipient: null,
    requester_id: 902094189446,
    submitter_id: 902095768443,
    assignee_id: 902095768443,
    organization_id: null,
    group_id: 900004607946,
    collaborator_ids: [],
    follower_ids: [],
    email_cc_ids: [],
    forum_topic_id: null,
    problem_id: null,
    has_incidents: false,
    is_public: true,
    due_at: null,
    tags: [ "sample", "support", "zendesk" ],
    custom_fields: [],
    satisfaction_rating: null,
    sharing_agreement_ids: [],
    fields: [],
    followup_ids: [],
    ticket_form_id: 900000356846,
    brand_id: 900001274646,
    allow_channelback: false,
    allow_attachments: true
  },
  {
    url: "https://samcheney.zendesk.com/api/v2/tickets/1.json",
    id: 1,
    external_id: null,
    via: { channel: "sample_ticket", source: { from: [Object], to: [Object], rel: null } },
    created_at: "2021-05-03T23:11:21Z",
    updated_at: "2021-05-03T23:11:22Z",
    type: "incident",
    subject: "Sample ticket: Meet the ticket",
    raw_subject: "Sample ticket: Meet the ticket",
    description: "Hi Sam,\n\nThis is your first ticket. Ta-da! Any customer request sent to your supported channels (ema...",
    priority: "normal",
    status: "open",
    recipient: null,
    requester_id: 902094189446,
    submitter_id: 902095768443,
    assignee_id: 902095768443,
    organization_id: null,
    group_id: 900004607946,
    collaborator_ids: [],
    follower_ids: [],
    email_cc_ids: [],
    forum_topic_id: null,
    problem_id: null,
    has_incidents: false,
    is_public: true,
    due_at: null,
    tags: [ "sample", "support", "zendesk" ],
    custom_fields: [],
    satisfaction_rating: null,
    sharing_agreement_ids: [],
    fields: [],
    followup_ids: [],
    ticket_form_id: 900000356846,
    brand_id: 900001274646,
    allow_channelback: false,
    allow_attachments: true
  },
  {
    url: "https://samcheney.zendesk.com/api/v2/tickets/1.json",
    id: 1,
    external_id: null,
    via: { channel: "sample_ticket", source: { from: [Object], to: [Object], rel: null } },
    created_at: "2021-05-03T23:11:21Z",
    updated_at: "2021-05-03T23:11:22Z",
    type: "incident",
    subject: "Sample ticket: Meet the ticket",
    raw_subject: "Sample ticket: Meet the ticket",
    description: "Hi Sam,\n\nThis is your first ticket. Ta-da! Any customer request sent to your supported channels (ema...",
    priority: "normal",
    status: "open",
    recipient: null,
    requester_id: 902094189446,
    submitter_id: 902095768443,
    assignee_id: 902095768443,
    organization_id: null,
    group_id: 900004607946,
    collaborator_ids: [],
    follower_ids: [],
    email_cc_ids: [],
    forum_topic_id: null,
    problem_id: null,
    has_incidents: false,
    is_public: true,
    due_at: null,
    tags: [ "sample", "support", "zendesk" ],
    custom_fields: [],
    satisfaction_rating: null,
    sharing_agreement_ids: [],
    fields: [],
    followup_ids: [],
    ticket_form_id: 900000356846,
    brand_id: 900001274646,
    allow_channelback: false,
    allow_attachments: true
  },
  {
    url: "https://samcheney.zendesk.com/api/v2/tickets/1.json",
    id: 1,
    external_id: null,
    via: { channel: "sample_ticket", source: { from: [Object], to: [Object], rel: null } },
    created_at: "2021-05-03T23:11:21Z",
    updated_at: "2021-05-03T23:11:22Z",
    type: "incident",
    subject: "Sample ticket: Meet the ticket",
    raw_subject: "Sample ticket: Meet the ticket",
    description: "Hi Sam,\n\nThis is your first ticket. Ta-da! Any customer request sent to your supported channels (ema...",
    priority: "normal",
    status: "open",
    recipient: null,
    requester_id: 902094189446,
    submitter_id: 902095768443,
    assignee_id: 902095768443,
    organization_id: null,
    group_id: 900004607946,
    collaborator_ids: [],
    follower_ids: [],
    email_cc_ids: [],
    forum_topic_id: null,
    problem_id: null,
    has_incidents: false,
    is_public: true,
    due_at: null,
    tags: [ "sample", "support", "zendesk" ],
    custom_fields: [],
    satisfaction_rating: null,
    sharing_agreement_ids: [],
    fields: [],
    followup_ids: [],
    ticket_form_id: 900000356846,
    brand_id: 900001274646,
    allow_channelback: false,
    allow_attachments: true
  },
  {
    url: "https://samcheney.zendesk.com/api/v2/tickets/1.json",
    id: 1,
    external_id: null,
    via: { channel: "sample_ticket", source: { from: [Object], to: [Object], rel: null } },
    created_at: "2021-05-03T23:11:21Z",
    updated_at: "2021-05-03T23:11:22Z",
    type: "incident",
    subject: "Sample ticket: Meet the ticket",
    raw_subject: "Sample ticket: Meet the ticket",
    description: "Hi Sam,\n\nThis is your first ticket. Ta-da! Any customer request sent to your supported channels (ema...",
    priority: "normal",
    status: "open",
    recipient: null,
    requester_id: 902094189446,
    submitter_id: 902095768443,
    assignee_id: 902095768443,
    organization_id: null,
    group_id: 900004607946,
    collaborator_ids: [],
    follower_ids: [],
    email_cc_ids: [],
    forum_topic_id: null,
    problem_id: null,
    has_incidents: false,
    is_public: true,
    due_at: null,
    tags: [ "sample", "support", "zendesk" ],
    custom_fields: [],
    satisfaction_rating: null,
    sharing_agreement_ids: [],
    fields: [],
    followup_ids: [],
    ticket_form_id: 900000356846,
    brand_id: 900001274646,
    allow_channelback: false,
    allow_attachments: true
  }
]

      // TODO change back to 25
      const paginationState = {
        ticketArray: array,
        pages: 1,
        rows: 5,
      }


      function pagination (ticketArray, page, rows) {
        let startPoint = (page - 1) * rows
        let endPoint = startPoint + rows

        let ticketPage = ticketArray.slice(startPoint, endPoint)

        let pages = Math.ceil(ticketArray.length / rows)

        return {
          ticketArray: ticketPage,
          pages: pages
        }
      }

      let data = pagination(paginationState.ticketArray, paginationState.page, paginationState.rows)
      console.log('Data', data)

      function buildTable () {
        const table = document.getElementById('table-body')

        array.forEach((index) => {
          let row = document.createElement('tr')
          let td1 = row.appendChild(document.createElement('td'))
          let text1 = td1.appendChild(document.createTextNode(`${index.subject}`))
          let td2 = row.appendChild(document.createElement('td'))
          let text2 = td2.appendChild(document.createTextNode(`${index.priority}`))
          
          table.append(row)
        })
        pageButtons(data.pages)
      }

      buildTable()

      function pageButtons(pages) {
        const wrapper = document.getElementById('pagination')
        wrapper.innerHTML = ''

        for (let index = 1; index <= pages; index ++) {
          wrapper.innerHTML += `<button value=${index}>${index}</button>`
        }
      }

    
      const buildUL = (array) => {
        let list = document.createElement('ul')
        array.forEach((index) => {

          // Build the List elements for the User Interface based on JSON list
          let ticket = document.createElement('li')
          let ticketLink = ticket.appendChild(document.createElement('a'))
          ticketLink.setAttribute('href', index.url)

          ticketLink.appendChild(document.createTextNode(`${index.subject} - Priority: ${index.priority}`))

          list.appendChild(ticket)

        })

        return list
      }
      document.getElementById('ticketingWindow').appendChild(buildUL(array))

    </script>
  </body>
</html>